!function(e,t){function i(e,t){var i=Object.prototype.toString.call(e).slice(8,-1).toLowerCase();return t?i===t:i}function n(e){var t,i,n=0;for(t=e.length-1;t>=0;t--)i=Math.max(e.eq(t).height(),+e.eq(t).data("min-height")),i>n&&(n=i);return n}function o(e){var t,i,n,o,s=[];for(i=e.length-1;i>=0;i--)for(t=e.eq(i).data("by"),n=0;n<t.length;n++)o=t.eq(n).height(),(!s[n]||s[n]<o)&&(s[n]=o);return s}function s(e){var t,i,n;for(t=e.get(0).getBoundingClientRect().bottom,i=0,n=e.length;n>i;i++)if(e.get(i).getBoundingClientRect().top>=t)return i;return e.length}function r(e,t){if("byinner"===t||"byinners"===t)for(var i=e.length-1;i>=0;i--)e.eq(i).data("by").css("min-height",1);else e.css("min-height",1)}function a(e,t,n){var o,s,r,a,h;for(o=e.length-1;o>=0;o--)if(r=e.eq(o),a=r.height(),!(a>=t))if("byitem"===n)h=0,("border-box"===r.css("box-sizing")||"padding-box"===r.css("box-sizing"))&&(h=r.outerHeight()-a),r.css("min-height",t+h);else if("byinner"===n)r.data("by").css("min-height",r.data("by").height()+(t-a));else if(i(t,"array"))for(s=0;s<r.data("by").length;s++)r.data("by").eq(s).css("min-height",t[s])}var h="alignelements",l=e(t),g=function(t,n){var o=this;if(o.$element=t,o.opt={items:null,by:null,liquid:!0},n.length)switch(n.length){case 1:switch(i(n[0])){case"boolean":o.opt.liquid=n[0];break;case"string":o.opt.by=n[0];break;case"object":o.opt=e.extend(o.opt,n[0])}break;case 2:o.opt.by=n[0],o.opt.liquid=n[1]}o.init()};g.prototype={init:function(){function e(){var e=o.getColCount();o.cols!==e&&(o.update(),o.cols=e)}var t,n,o=this;if(o.inited&&o.uninit(),o.$items=i(o.opt.items,"null")?o.$element.children():o.$element.find(o.opt.items),o.$items.length){if(i(o.opt.by,"string"))for(t=o.$items.length-1;t>=0;t--)n=o.$items.eq(t),n.data("by",n.find(o.opt.by)),1===n.data("by").length?o.mode="byinner":n.data("by").length>1&&(o.mode="byinners");for(o.mode||(o.mode="byitem"),o.opt.liquid&&(o.cols||(o.cols=o.getColCount()),o._onresize=e,l.on("resize."+h,o._onresize)),t=o.$items.length-1;t>=0;t--)n=o.$items.eq(t),n.data("min-height",parseInt(n.css("min-height")));o.inited=!0,o.align()}},uninit:function(){var e,t=this;if(t._onresize&&l.off("resize."+h,t._onresize),"byitem"===t.mode)t.$items.css("min-height","");else if("byinner"===t.mode||"byinners"===t.mode)for(e=t.$items.length-1;e>=0;e--)t.$items.eq(e).data("by").css("min-height","");t.$items.removeData("by min-height")},destroy:function(){var e=this;e.uninit(),e.$element.removeData(h)},align:function(){var e,t,i=this,s=i.getColCount(),h=0,l=0;r(i.$items,i.mode);do t=i.$items.slice(h,h+s),"byitem"===i.mode||"byinner"===i.mode?(l=n(t),a(t,l,i.mode)):"byinners"===i.mode&&(e=o(t),a(t,e)),h+=s;while(i.$items.length-h>0)},update:function(t){var i=this;e.isPlainObject(t)&&(i.opt=e.extend(i.opt,t)),i.init()},getColCount:function(){return s(this.$items)},getMode:function(){return this.mode}},e.fn[h]=function(t,i){var n=Array.prototype.slice.call(arguments);return this.each(function(){var o,s=e(this);(o=s.data(h))?"string"==typeof t&&o[t]?o[t](i):o.update(t):s.data(h,new g(s,n))})}}(jQuery,window);
