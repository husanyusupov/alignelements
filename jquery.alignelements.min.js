!function(e,t){"use strict";function i(e,t){var i=Object.prototype.toString.call(e).slice(8,-1).toLowerCase();return"object"===i&&void 0==e&&(i="null"),t?i===t:i}function n(e){var t,i,n=0;for(t=e.length-1;t>=0;t--)i=Math.max(e.eq(t).height(),+e.eq(t).data("min-height")||0),i>n&&(n=i);return n}function o(e){var t,i,n,o,r=[];for(i=e.length-1;i>=0;i--)for(t=e.eq(i).data("by"),n=0;n<t.length;n++)o=t.eq(n).height(),(!r[n]||r[n]<o)&&(r[n]=o);return r}function r(e){var t,i,n;for(t=e.get(0).getBoundingClientRect().bottom,i=0,n=e.length;n>i;i++)if(e.get(i).getBoundingClientRect().top>=t)return i;return e.length}function s(e,t){if("byinner"===t||"byinners"===t)for(var i=e.length-1;i>=0;i--)e.eq(i).data("by").css("min-height",1);else e.css("min-height",1)}function a(e,t,n){var o,r,s,a,l;for(o=e.length-1;o>=0;o--)if(s=e.eq(o),a=s.height(),!(a>=t))if("byitem"===n){switch(l=0,s.css("box-sizing")){case"border-box":l=s.outerHeight()-a;break;case"padding-box":l=s.innerHeight()-a}s.css("min-height",t+l)}else if("byinner"===n)s.data("by").css("min-height",s.data("by").height()+(t-a));else if(i(t,"array"))for(r=0;r<s.data("by").length;r++)s.data("by").eq(r).css("min-height",t[r])}function l(){var e=Object.prototype.hasOwnProperty;return e.call(t,"devicePixelRatio")?t.devicePixelRatio:e.call(screen,"deviceXDPI")?screen.deviceXDPI/screen.logicalXDPI:void 0}var h="alignelements",c=e(t),g=function(t,n){var o=this;if(o.$element=t,o.opt={items:null,by:null,liquid:!0},n.length)switch(n.length){case 1:switch(i(n[0])){case"boolean":o.opt.liquid=n[0];break;case"string":o.opt.by=n[0];break;case"object":o.opt=e.extend(o.opt,n[0])}break;case 2:o.opt.by=n[0],o.opt.liquid=n[1]}o.init()};g.prototype={init:function(){function e(){var e,t,i=!1;n.opt.liquid&&n.cols!==(e=n.getColCount())&&(i=!0,n.cols=e),n.ratio!==(t=l())&&(i=!0,n.ratio=t),i&&n.align()}var t,i,n=this;if(n.inited&&n.uninit(),n.$items=n.opt.items?n.$element.find(n.opt.items):n.$element.children(),n.$items.length){if(n.opt.by)for(t=n.$items.length-1;t>=0;t--)i=n.$items.eq(t),i.data("by",i.find(n.opt.by)),1===i.data("by").length?n.mode="byinner":i.data("by").length>1&&(n.mode="byinners");for(n.mode||(n.mode="byitem"),t=n.$items.length-1;t>=0;t--)i=n.$items.eq(t),i.data("min-height",parseInt(i.css("min-height")));n.cols=n.getColCount(),n.ratio=l(),n.inited=!0,n.align(),n._onresize=e,c.on("resize."+h,n._onresize)}},uninit:function(){var e,t=this;if(t._onresize&&c.off("resize."+h,t._onresize),"byitem"===t.mode)t.$items.css("min-height","");else if("byinner"===t.mode||"byinners"===t.mode)for(e=t.$items.length-1;e>=0;e--)t.$items.eq(e).data("by").css("min-height","");t.$items.removeData("by min-height")},destroy:function(){var e=this;e.uninit(),e.$element.removeData(h)},align:function(){var e,t,i=this,r=i.getColCount(),l=0,h=0;s(i.$items,i.mode);do t=i.$items.slice(l,l+r),"byitem"===i.mode||"byinner"===i.mode?(h=n(t),a(t,h,i.mode)):"byinners"===i.mode&&(e=o(t),a(t,e)),l+=r;while(i.$items.length-l>0)},update:function(t){var i=this;e.isPlainObject(t)&&(i.opt=e.extend(i.opt,t)),i.init()},getColCount:function(){return r(this.$items)},getMode:function(){return this.mode}},e.fn[h]=function(t,i){var n=Array.prototype.slice.call(arguments);return this.each(function(){var o,r=e(this);(o=r.data(h))?"string"==typeof t&&o[t]?o[t](i):o.update(t):r.data(h,new g(r,n))})}}(jQuery,window);
